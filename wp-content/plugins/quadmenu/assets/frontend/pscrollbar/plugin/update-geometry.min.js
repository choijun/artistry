
"use strict";var _=require("../lib/helper");var cls=require("../lib/class");var dom=require("../lib/dom");var instances=require("./instances");var updateScroll=require("./update-scroll");function getThumbSize(b,a){if(b.settings.minScrollbarLength){a=Math.max(a,b.settings.minScrollbarLength)}if(b.settings.maxScrollbarLength){a=Math.min(a,b.settings.maxScrollbarLength)}return a}function updateCss(c,b){var a={width:b.railXWidth};if(b.isRtl){a.left=b.negativeScrollAdjustment+c.scrollLeft+b.containerWidth-b.contentWidth}else{a.left=c.scrollLeft}if(b.isScrollbarXUsingBottom){a.bottom=b.scrollbarXBottom-c.scrollTop}else{a.top=b.scrollbarXTop+c.scrollTop}dom.css(b.scrollbarXRail,a);var d={top:c.scrollTop,height:b.railYHeight};if(b.isScrollbarYUsingRight){if(b.isRtl){d.right=b.contentWidth-(b.negativeScrollAdjustment+c.scrollLeft)-b.scrollbarYRight-b.scrollbarYOuterWidth}else{d.right=b.scrollbarYRight-c.scrollLeft}}else{if(b.isRtl){d.left=b.negativeScrollAdjustment+c.scrollLeft+b.containerWidth*2-b.contentWidth-b.scrollbarYLeft-b.scrollbarYOuterWidth}else{d.left=b.scrollbarYLeft+c.scrollLeft}}dom.css(b.scrollbarYRail,d);dom.css(b.scrollbarX,{left:b.scrollbarXLeft,width:b.scrollbarXWidth-b.railBorderXWidth});dom.css(b.scrollbarY,{top:b.scrollbarYTop,height:b.scrollbarYHeight-b.railBorderYWidth})}module.exports=function(b){var a=instances.get(b);a.containerWidth=b.clientWidth;a.containerHeight=b.clientHeight;a.contentWidth=b.scrollWidth;a.contentHeight=b.scrollHeight;var c;if(!b.contains(a.scrollbarXRail)){c=dom.queryChildren(b,".ps-scrollbar-x-rail");if(c.length>0){c.forEach(function(d){dom.remove(d)})}dom.appendTo(a.scrollbarXRail,b)}if(!b.contains(a.scrollbarYRail)){c=dom.queryChildren(b,".ps-scrollbar-y-rail");if(c.length>0){c.forEach(function(d){dom.remove(d)})}dom.appendTo(a.scrollbarYRail,b)}if(!a.settings.suppressScrollX&&a.containerWidth+a.settings.scrollXMarginOffset<a.contentWidth){a.scrollbarXActive=true;a.railXWidth=a.containerWidth-a.railXMarginWidth;a.railXRatio=a.containerWidth/a.railXWidth;a.scrollbarXWidth=getThumbSize(a,_.toInt(a.railXWidth*a.containerWidth/a.contentWidth));a.scrollbarXLeft=_.toInt((a.negativeScrollAdjustment+b.scrollLeft)*(a.railXWidth-a.scrollbarXWidth)/(a.contentWidth-a.containerWidth))}else{a.scrollbarXActive=false}if(!a.settings.suppressScrollY&&a.containerHeight+a.settings.scrollYMarginOffset<a.contentHeight){a.scrollbarYActive=true;a.railYHeight=a.containerHeight-a.railYMarginHeight;a.railYRatio=a.containerHeight/a.railYHeight;a.scrollbarYHeight=getThumbSize(a,_.toInt(a.railYHeight*a.containerHeight/a.contentHeight));a.scrollbarYTop=_.toInt(b.scrollTop*(a.railYHeight-a.scrollbarYHeight)/(a.contentHeight-a.containerHeight))}else{a.scrollbarYActive=false}if(a.scrollbarXLeft>=a.railXWidth-a.scrollbarXWidth){a.scrollbarXLeft=a.railXWidth-a.scrollbarXWidth}if(a.scrollbarYTop>=a.railYHeight-a.scrollbarYHeight){a.scrollbarYTop=a.railYHeight-a.scrollbarYHeight}updateCss(b,a);if(a.scrollbarXActive){cls.add(b,"ps-active-x")}else{cls.remove(b,"ps-active-x");a.scrollbarXWidth=0;a.scrollbarXLeft=0;updateScroll(b,"left",0)}if(a.scrollbarYActive){cls.add(b,"ps-active-y")}else{cls.remove(b,"ps-active-y");a.scrollbarYHeight=0;a.scrollbarYTop=0;updateScroll(b,"top",0)}};